{"ast":null,"code":"/*\r\nimport dbConnect from '../../../lib/mongoose/dbConnect';\r\nimport Product from '../../../lib/mongoose/Product';\r\n\r\ndbConnect();\r\n*/\nimport { connectToDatabase } from '../../../lib/mongoose/dbCon';\nexport default (async (req, res) => {\n  const {\n    db\n  } = await connectToDatabase();\n  const {\n    method,\n    headers,\n    query\n  } = req;\n\n  switch (method) {\n    case 'GET':\n      try {\n        const limit = parseInt(await query.limit);\n        const skip = (await (parseInt(query.page) - 1)) * limit;\n        const response = await db.collection(headers.shopname).find().skip(skip).limit(limit).toArray();\n        res.status(200).json({\n          success: true,\n          products: response\n        });\n      } catch (error) {\n        res.status(400).json({\n          success: false\n        });\n      }\n\n      break;\n\n    case 'POST':\n      try {\n        //const product = await Product.create(req.body)\n        const response = await db.collection(headers.shopname).insertOne(req.body);\n        res.status(201).json({\n          success: true,\n          data: response\n        });\n      } catch (error) {\n        res.status(400).json({\n          success: false,\n          error: error\n        });\n      }\n\n      break;\n\n    default:\n      res.status(400).json({\n        success: false\n      });\n      break;\n  }\n});","map":{"version":3,"sources":["E:/novostack/shopify/apps/ns-nextjs-shopify/pages/api/products/index.js"],"names":["connectToDatabase","req","res","db","method","headers","query","limit","parseInt","skip","page","response","collection","shopname","find","toArray","status","json","success","products","error","insertOne","body","data"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AAEA,SAAQA,iBAAR,QAAgC,6BAAhC;AAEA,gBAAe,OAAOC,GAAP,EAAWC,GAAX,KAAmB;AAC9B,QAAM;AAACC,IAAAA;AAAD,MAAO,MAAMH,iBAAiB,EAApC;AACA,QAAM;AAACI,IAAAA,MAAD;AAAQC,IAAAA,OAAR;AAAgBC,IAAAA;AAAhB,MAAyBL,GAA/B;;AACA,UAAOG,MAAP;AACI,SAAK,KAAL;AACI,UAAG;AAEC,cAAMG,KAAK,GAAGC,QAAQ,CAAC,MAAMF,KAAK,CAACC,KAAb,CAAtB;AACA,cAAME,IAAI,GAAG,QAAQD,QAAQ,CAACF,KAAK,CAACI,IAAP,CAAR,GAAuB,CAA/B,KAAoCH,KAAjD;AACA,cAAMI,QAAQ,GAAG,MAAMR,EAAE,CAACS,UAAH,CAAcP,OAAO,CAACQ,QAAtB,EAAgCC,IAAhC,GACtBL,IADsB,CACjBA,IADiB,EAEtBF,KAFsB,CAEhBA,KAFgB,EAGtBQ,OAHsB,EAAvB;AAKAb,QAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,UAAAA,OAAO,EAAC,IAAT;AAAcC,UAAAA,QAAQ,EAACR;AAAvB,SAArB;AACH,OAVD,CAUC,OAAMS,KAAN,EAAY;AACTlB,QAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,UAAAA,OAAO,EAAC;AAAT,SAArB;AACH;;AACD;;AACJ,SAAK,MAAL;AACI,UAAG;AACC;AACA,cAAMP,QAAQ,GAAG,MAAMR,EAAE,CAACS,UAAH,CAAcP,OAAO,CAACQ,QAAtB,EAAgCQ,SAAhC,CAA0CpB,GAAG,CAACqB,IAA9C,CAAvB;AACApB,QAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,UAAAA,OAAO,EAAC,IAAT;AAAcK,UAAAA,IAAI,EAACZ;AAAnB,SAArB;AACH,OAJD,CAIC,OAAMS,KAAN,EAAY;AACTlB,QAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,UAAAA,OAAO,EAAC,KAAT;AAAeE,UAAAA,KAAK,EAACA;AAArB,SAArB;AACH;;AACD;;AACJ;AACIlB,MAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,QAAAA,OAAO,EAAC;AAAT,OAArB;AACA;AA3BR;AA6BH,CAhCD","sourcesContent":["/*\r\nimport dbConnect from '../../../lib/mongoose/dbConnect';\r\nimport Product from '../../../lib/mongoose/Product';\r\n\r\ndbConnect();\r\n*/\r\n\r\nimport {connectToDatabase} from '../../../lib/mongoose/dbCon';\r\n\r\nexport default async (req,res) => {\r\n    const {db} = await connectToDatabase();\r\n    const {method,headers,query} = req;\r\n    switch(method){\r\n        case 'GET':\r\n            try{\r\n                \r\n                const limit = parseInt(await query.limit);\r\n                const skip = await ( parseInt(query.page) - 1) * limit;        \r\n                const response = await db.collection(headers.shopname).find()\r\n                .skip(skip)\r\n                .limit(limit)\r\n                .toArray();\r\n                \r\n                res.status(200).json({success:true,products:response})\r\n            }catch(error){\r\n                res.status(400).json({success:false})\r\n            }\r\n            break;\r\n        case 'POST':\r\n            try{\r\n                //const product = await Product.create(req.body)\r\n                const response = await db.collection(headers.shopname).insertOne(req.body)\r\n                res.status(201).json({success:true,data:response})\r\n            }catch(error){\r\n                res.status(400).json({success:false,error:error})\r\n            }\r\n            break;\r\n        default:\r\n            res.status(400).json({success:false})\r\n            break;\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}